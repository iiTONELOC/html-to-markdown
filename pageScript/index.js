import { styles } from './styles';
import elements from './domElements';
import HTMLtoMarkdown from '../converter';
import { addStylesToEl, removeStylesFromEl } from './uiHelpers';
const hasHTMLRegex = /<[^>]*>/;
const hasHTML = (text) => hasHTMLRegex.test(text);
export default () => {
    if (typeof document !== 'undefined') {
        document.addEventListener('DOMContentLoaded', () => {
            const { HTMLInput, resetButton, convertButton, convertedHTMLContainer, copyConvertedHTMLButton, convertedParentContainer } = elements();
            const showConvertedHTML = (convertedHTML) => {
                convertedHTMLContainer.innerHTML = convertedHTML;
                convertedParentContainer.classList.remove('hidden');
                copyConvertedHTMLButton.scrollIntoView();
                copyConvertedHTMLButton
                    .addEventListener('click', handleCopyClick);
                resetButton.addEventListener('click', handleResetClick);
            };
            const hideConvertedHTMLEl = () => {
                convertedHTMLContainer.innerHTML = '';
                convertedHTMLContainer.innerHTML = '';
                convertedParentContainer.classList.add('hidden');
                copyConvertedHTMLButton
                    .removeEventListener('click', handleCopyClick);
                resetButton.removeEventListener('click', handleResetClick);
            };
            const convertBtnValidInputReceived = (inputReceived) => {
                addStylesToEl(convertButton, styles.convertButton);
                convertButton.disabled = false;
                convertButton.addEventListener('click', (e) => handleConvertButtonClick(inputReceived, e));
            };
            const resetConvertBtn = (inputReceived) => {
                convertButton.disabled = true;
                removeStylesFromEl(convertButton, styles.convertButton);
                convertButton.removeEventListener('click', (e) => handleConvertButtonClick(inputReceived, e));
            };
            const handleCopyClick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                const text = convertedHTMLContainer;
                text.select();
                text.setSelectionRange(0, 99999);
                navigator.clipboard.writeText(text.value);
            };
            const handleResetClick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                HTMLInput.value = '';
                hideConvertedHTMLEl();
            };
            const handleConvertButtonClick = async (value, e) => {
                e.preventDefault();
                e.stopPropagation();
                const converted = await HTMLtoMarkdown(value);
                showConvertedHTML(converted);
            };
            const htmlInputManager = (event) => {
                const target = event.target;
                const value = target.value;
                if (hasHTML(value)) {
                    convertBtnValidInputReceived(value);
                }
                else {
                    resetConvertBtn(value);
                    hideConvertedHTMLEl();
                }
            };
            HTMLInput.addEventListener('input', htmlInputManager);
        });
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvcGFnZVNjcmlwdC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ2xDLE9BQU8sUUFBUSxNQUFNLGVBQWUsQ0FBQztBQUNyQyxPQUFPLGNBQWMsTUFBTSxjQUFjLENBQUM7QUFDMUMsT0FBTyxFQUNILGFBQWEsRUFDYixrQkFBa0IsRUFDckIsTUFBTSxhQUFhLENBQUM7QUFFckIsTUFBTSxZQUFZLEdBQUcsU0FBUyxDQUFDO0FBRS9CLE1BQU0sT0FBTyxHQUFHLENBQUMsSUFBWSxFQUFXLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBRW5FLGVBQWUsR0FBRyxFQUFFO0lBQ2hCLElBQUksT0FBTyxRQUFRLEtBQUssV0FBVyxFQUFFO1FBQ2pDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxHQUFTLEVBQUU7WUFFckQsTUFBTSxFQUNGLFNBQVMsRUFDVCxXQUFXLEVBQ1gsYUFBYSxFQUNiLHNCQUFzQixFQUN0Qix1QkFBdUIsRUFDdkIsd0JBQXdCLEVBQzNCLEdBQUcsUUFBUSxFQUFFLENBQUM7WUFJZixNQUFNLGlCQUFpQixHQUFHLENBQUMsYUFBcUIsRUFBUSxFQUFFO2dCQUV0RCxzQkFBc0IsQ0FBQyxTQUFTLEdBQUcsYUFBYSxDQUFDO2dCQUdqRCx3QkFBd0IsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUlwRCx1QkFBdUIsQ0FBQyxjQUFjLEVBQUUsQ0FBQztnQkFHekMsdUJBQXVCO3FCQUNsQixnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsZUFBZSxDQUFDLENBQUM7Z0JBR2hELFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztZQUM1RCxDQUFDLENBQUM7WUFFRixN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QVMsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztRQUMxRCxDQUFDLENBQUMsQ0FBQztLQUNOO0FBQ0wsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3R5bGVzIH0gZnJvbSAnLi9zdHlsZXMnO1xyXG5pbXBvcnQgZWxlbWVudHMgZnJvbSAnLi9kb21FbGVtZW50cyc7XHJcbmltcG9ydCBIVE1MdG9NYXJrZG93biBmcm9tICcuLi9jb252ZXJ0ZXInO1xyXG5pbXBvcnQge1xyXG4gICAgYWRkU3R5bGVzVG9FbCxcclxuICAgIHJlbW92ZVN0eWxlc0Zyb21FbFxyXG59IGZyb20gJy4vdWlIZWxwZXJzJztcclxuXHJcbmNvbnN0IGhhc0hUTUxSZWdleCA9IC88W14+XSo+LztcclxuLy8gZnVuY3Rpb24gdG8gY2hlY2sgaWYgdGhlIHN0cmluZyBjb250YWlucyBIVE1MXHJcbmNvbnN0IGhhc0hUTUwgPSAodGV4dDogc3RyaW5nKTogYm9vbGVhbiA9PiBoYXNIVE1MUmVnZXgudGVzdCh0ZXh0KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0ICgpID0+IHtcclxuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgLy9fX19fX18gRE9NIEVMRU1FTlQgQ09OU1RBTlRTIF9fX19fX18vL1xyXG4gICAgICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgICAgICBIVE1MSW5wdXQsXHJcbiAgICAgICAgICAgICAgICByZXNldEJ1dHRvbixcclxuICAgICAgICAgICAgICAgIGNvbnZlcnRCdXR0b24sXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZWRIVE1MQ29udGFpbmVyLFxyXG4gICAgICAgICAgICAgICAgY29weUNvbnZlcnRlZEhUTUxCdXR0b24sXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZWRQYXJlbnRDb250YWluZXJcclxuICAgICAgICAgICAgfSA9IGVsZW1lbnRzKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBfX19fX18gVUkgSEVMUEVSIEZVTkNUSU9OUyBfX19fX18gLy9cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHNob3dDb252ZXJ0ZWRIVE1MID0gKGNvbnZlcnRlZEhUTUw6IHN0cmluZyk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjb252ZXJ0ZWQgSFRNTCB0byB0aGUgY29udmVydGVkIEhUTUwgY29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZWRIVE1MQ29udGFpbmVyLmlubmVySFRNTCA9IGNvbnZlcnRlZEhUTUw7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBoaWRkZW4gY2xhc3MgZnJvbSB0aGUgY29udmVydGVkIEhUTUwgY29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZWRQYXJlbnRDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2Nyb2xsIHRvIHRoZSBidXR0b24gaW50byB2aWV3IGZvciBhIG1vcmUgc2VhbWxlc3NcclxuICAgICAgICAgICAgICAgIC8vIGV4cGVyaWVuY2VcclxuICAgICAgICAgICAgICAgIGNvcHlDb252ZXJ0ZWRIVE1MQnV0dG9uLnNjcm9sbEludG9WaWV3KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gYXR0YWNoIHRoZSBldmVudCBsaXN0ZW5lciB0byB0aGUgY29weSBidXR0b25cclxuICAgICAgICAgICAgICAgIGNvcHlDb252ZXJ0ZWRIVE1MQnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ29weUNsaWNrKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBhdHRhY2ggdGhlIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSByZXNldCBidXR0b25cclxuICAgICAgICAgICAgICAgIHJlc2V0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlUmVzZXRDbGljayk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjb25zdCBoaWRlQ29udmVydGVkSFRNTEVsID0gKCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBjb252ZXJ0ZWQgSFRNTCBmcm9tIHRoZSBjb252ZXJ0ZWQgSFRNTCBjb250YWluZXJcclxuICAgICAgICAgICAgICAgIGNvbnZlcnRlZEhUTUxDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFueSB0ZXh0IGFuZCBoaWRlIHRoZSBwYXJlbnQgY29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZWRIVE1MQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgY29udmVydGVkUGFyZW50Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXIgZnJvbSB0aGUgY29weSBidXR0b25cclxuICAgICAgICAgICAgICAgIGNvcHlDb252ZXJ0ZWRIVE1MQnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ29weUNsaWNrKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyIGZyb20gdGhlIHJlc2V0IGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgcmVzZXRCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVSZXNldENsaWNrKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnRCdG5WYWxpZElucHV0UmVjZWl2ZWQgPSAoaW5wdXRSZWNlaXZlZDogc3RyaW5nKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgdGhlIHN0eWxlcyB0byB0aGUgY29udmVydCBidXR0b25cclxuICAgICAgICAgICAgICAgIGFkZFN0eWxlc1RvRWwoY29udmVydEJ1dHRvbiwgc3R5bGVzLmNvbnZlcnRCdXR0b24pO1xyXG4gICAgICAgICAgICAgICAgY29udmVydEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGF0dGFjaCB0aGUgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNvbnZlcnQgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWNrJyxcclxuICAgICAgICAgICAgICAgICAgICAoZTogRXZlbnQpID0+IGhhbmRsZUNvbnZlcnRCdXR0b25DbGljayhpbnB1dFJlY2VpdmVkLCBlKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc2V0Q29udmVydEJ0biA9IChpbnB1dFJlY2VpdmVkOiBzdHJpbmcpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgc3R5bGVzIGFuZCBkaXNhYmxlIHRoZSBidXR0b25cclxuICAgICAgICAgICAgICAgIGNvbnZlcnRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlU3R5bGVzRnJvbUVsKGNvbnZlcnRCdXR0b24sIHN0eWxlcy5jb252ZXJ0QnV0dG9uKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyIGZyb20gdGhlIGNvbnZlcnQgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0QnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWNrJyxcclxuICAgICAgICAgICAgICAgICAgICAoZTogRXZlbnQpID0+IGhhbmRsZUNvbnZlcnRCdXR0b25DbGljayhpbnB1dFJlY2VpdmVkLCBlKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vX19fX19FVkVOVCBIQU5ETEVSIEZVTkNUSU9OU19fX19fLy9cclxuXHJcbiAgICAgICAgICAgIC8vIGNvcGllcyB0aGUgY29udmVydGVkIEhUTUwgdG8gdGhlIGNsaXBib2FyZFxyXG4gICAgICAgICAgICBjb25zdCBoYW5kbGVDb3B5Q2xpY2sgPSAoZTogRXZlbnQpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY29weSB0aGUgY29udmVydGVkIEhUTUwgdG8gdGhlIGNsaXBib2FyZFxyXG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGNvbnZlcnRlZEhUTUxDb250YWluZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY29weSB0aGUgdGV4dCB0byB0aGUgY2xpcGJvYXJkXHJcbiAgICAgICAgICAgICAgICB0ZXh0LnNlbGVjdCgpO1xyXG4gICAgICAgICAgICAgICAgLy8gRm9yIG1vYmlsZSBkZXZpY2VzXHJcbiAgICAgICAgICAgICAgICB0ZXh0LnNldFNlbGVjdGlvblJhbmdlKDAsIDk5OTk5KTtcclxuXHJcbiAgICAgICAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0ZXh0LnZhbHVlKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJlc2V0cyB0aGUgVUlcclxuICAgICAgICAgICAgY29uc3QgaGFuZGxlUmVzZXRDbGljayA9IChlOiBFdmVudCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZXNldCB0aGUgSFRNTCBpbnB1dFxyXG4gICAgICAgICAgICAgICAgSFRNTElucHV0LnZhbHVlID0gJyc7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgdGhlIGNvbnZlcnRlZCBIVE1MIGNvbnRhaW5lclxyXG4gICAgICAgICAgICAgICAgaGlkZUNvbnZlcnRlZEhUTUxFbCgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8gQ292ZXJ0cyBNYXJrZG93biB0byBIVE1MIGFuZCBkaXNwbGF5cyBpdCBpbiB0aGUgY29udmVydGVkSFRNTENvbnRhaW5lclxyXG4gICAgICAgICAgICBjb25zdCBoYW5kbGVDb252ZXJ0QnV0dG9uQ2xpY2sgPSBhc3luYyAodmFsdWU6IHN0cmluZywgZTogRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcGFyc2UgdGhlIEhUTUwgYW5kIGNvbnZlcnQgaXQgdG8gTWFya2Rvd25cclxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IGNvbnZlcnRlZCA9IHBhcnNlSFRNTCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb252ZXJ0ZWQgPSBhd2FpdCBIVE1MdG9NYXJrZG93bih2YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZGlzcGxheSB0aGUgY29udmVydGVkIEhUTUxcclxuICAgICAgICAgICAgICAgIHNob3dDb252ZXJ0ZWRIVE1MKGNvbnZlcnRlZCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBIYW5kbGVzIHRoZSBpbnB1dCBldmVudCBvbiB0aGUgSFRNTElucHV0IGFuZCBhbnkgaW5wdXQgY2hhbmdlc1xyXG4gICAgICAgICAgICAvLyBNYW5hZ2VzIHRoZSBzdGF0ZSBmb3IgdGhlIGJ1dHRvbnMgYW5kIHRoZSBjb252ZXJ0ZWRIVE1MQ29udGFpbmVyXHJcbiAgICAgICAgICAgIGNvbnN0IGh0bWxJbnB1dE1hbmFnZXIgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGFyZ2V0LnZhbHVlO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgdmFsdWUgY29udGFpbnMgSFRNTCB0aGVuIGF0dGFjaCBvdXIgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzSFRNTCh2YWx1ZSkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29udmVydEJ0blZhbGlkSW5wdXRSZWNlaXZlZCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc2V0Q29udmVydEJ0bih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZUNvbnZlcnRlZEhUTUxFbCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8gYWRkIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBodG1sIGlucHV0IGFuZCBtYW5hZ2UgYW55IGNoYW5nZXNcclxuICAgICAgICAgICAgSFRNTElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaHRtbElucHV0TWFuYWdlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcbiJdfQ==